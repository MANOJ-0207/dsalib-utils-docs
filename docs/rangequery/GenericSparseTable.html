<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GenericSparseTable - Docs</title>
    <link rel="stylesheet" href="../../../styles/docs.css" />
    <link
      rel="icon"
      type="image/x-icon"
      href="../assets/dependency-favicon.png"
    />
  </head>
  <body>
    <!-- Theme Toggle Button -->
    <div
      class="theme-toggle"
      onclick="toggleTheme()"
      title="Toggle Theme"
      id="theme-toggle"
    >
      <img id="icon-sun" src="../../../assets/sun.png" />
      <img id="icon-moon" src="../../../assets/moon.png" />
    </div>

    <div class="doc-container">
      <header>
        <h1>GenericSparseTable</h1>
        <p class="class-type">
          Type: <span class="tag class-tag">Concrete Class</span>
        </p>
      </header>

      <!-- Overview -->
      <section class="doc-section">
        <h2>Description</h2>
        <p>
          <code>GenericSparseTable&lt;T&gt;</code> is a generic implementation
          of the sparse table data structure used for answering range queries
          efficiently on static arrays.
        </p>
        <p>
          It supports both <b>overlap-safe</b> operations (like
          <code>min</code>, <code>max</code>, <code>gcd</code>) with
          <code>O(1)</code> query time, and <b>non-overlap-safe</b> operations
          (like <code>sum</code>) with <code>O(log n)</code> query time.
        </p>
      </section>

      <!-- Use Cases -->
      <section class="doc-section">
        <h2>Use Cases</h2>
        <ul>
          <li>Fast range queries on immutable data</li>
          <li>Ideal for problems requiring min/max/gcd over subarrays</li>
          <li>Preprocessing-heavy, but ultra-fast query access</li>
        </ul>
      </section>

      <!-- Method Summary -->
      <section class="doc-section">
        <h2>Method Summary</h2>
        <table class="doc-table">
          <thead>
            <tr>
              <th>Return Type</th>
              <th>Method</th>
              <th>Description</th>
              <th>Time Complexity</th>
            </tr>
          </thead>
          <tbody>
            <!-- Constructors -->
            <tr>
              <td><code>N/A</code></td>
              <td>
                <code
                  >GenericSparseTable(T[] input, BinaryOperator&lt;T&gt;
                  op)</code
                >
              </td>
              <td>
                Constructs a sparse table using an array and a binary operator
                (overlap-safe assumed false)
              </td>
              <td><b>O(n log n)</b></td>
            </tr>
            <tr>
              <td><code>N/A</code></td>
              <td>
                <code
                  >GenericSparseTable(T[] input, BinaryOperator&lt;T&gt; op,
                  boolean isOverlapSafe)</code
                >
              </td>
              <td>
                Constructs a sparse table from an array with a custom
                overlap-safe configuration
              </td>
              <td><b>O(n log n)</b></td>
            </tr>
            <tr>
              <td><code>N/A</code></td>
              <td>
                <code
                  >GenericSparseTable(List&lt;T&gt; input,
                  BinaryOperator&lt;T&gt; op, boolean isOverlapSafe)</code
                >
              </td>
              <td>
                Constructs a sparse table from a list input with custom
                overlap-safe configuration
              </td>
              <td><b>O(n log n)</b></td>
            </tr>

            <!-- Methods -->
            <tr>
              <td><code>T</code></td>
              <td><code>query(int l, int r)</code></td>
              <td>
                Returns the result of the binary operation over the range
                <code>[l, r]</code>
              </td>
              <td><b>O(1)</b> if overlap-safe, <b>O(log n)</b> otherwise</td>
            </tr>
            <tr>
              <td><code>T[][]</code></td>
              <td><code>getTable()</code></td>
              <td>Returns the internal precomputed 2D sparse table</td>
              <td><b>O(1)</b></td>
            </tr>
            <tr>
              <td><code>List&lt;List&lt;T&gt;&gt;</code></td>
              <td><code>getTableAsLists()</code></td>
              <td>Returns the sparse table as a list of rows</td>
              <td><b>O(n log n)</b></td>
            </tr>
            <tr>
              <td><code>boolean</code></td>
              <td><code>isOverlapSafe()</code></td>
              <td>Returns whether the operation used is overlap-safe</td>
              <td><b>O(1)</b></td>
            </tr>
            <tr>
              <td><code>int</code></td>
              <td><code>size()</code></td>
              <td>Returns the size of the original array</td>
              <td><b>O(1)</b></td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="doc-section">
        <h2>Algorithm Details</h2>
        <p>
          The <code>GenericSparseTable</code> supports fast range queries over
          static, immutable data using precomputed overlapping intervals. It is
          optimized for idempotent operations like <code>min</code>,
          <code>max</code>, and <code>gcd</code>, but can also handle
          non-overlap-safe operations like <code>sum</code> using disjoint
          intervals.
        </p>

        <p><strong>Key Concepts:</strong></p>
        <ul>
          <li>
            Precomputes results for all intervals of size 2<sup>k</sup> for k =
            0 to ⌊log n⌋
          </li>
          <li>
            For overlap-safe operations: queries are answered in O(1) using two
            overlapping intervals
          </li>
          <li>
            For non-overlap-safe operations: queries are broken into disjoint
            intervals in O(log n)
          </li>
        </ul>

        <p><strong>Operations Supported:</strong></p>
        <ul>
          <li>
            <code>query(l, r)</code>: returns the result of applying the
            operation over range [l, r]
          </li>
          <li>
            <code>getTable()</code>: returns raw 2D array used for preprocessing
          </li>
          <li>
            <code>getTableAsLists()</code>: returns table rows as list-of-lists
          </li>
          <li>
            <code>isOverlapSafe()</code>: tells whether the given operation
            supports overlapping intervals
          </li>
        </ul>

        <p><strong>Time Complexity:</strong></p>
        <ul>
          <li><code>Construction</code>: O(n log n)</li>
          <li><code>Query</code>: O(1) if overlap-safe, O(log n) otherwise</li>
        </ul>

        <p><strong>Space Complexity:</strong> O(n log n)</p>
        <ul>
          <li>
            Stores ⌊log<sub>2</sub> n⌋ levels of size up to n, giving O(n log n)
            storage
          </li>
          <li>
            Each level <code>k</code> stores precomputed results for intervals
            of size 2<sup>k</sup>
          </li>
        </ul>

        <p>This data structure is best suited for:</p>
        <ul>
          <li>Static arrays where updates are not required</li>
          <li>
            Fast range queries over <code>min</code>, <code>max</code>,
            <code>gcd</code>, etc.
          </li>
          <li>
            Competitive programming and scenarios where preprocessing is
            acceptable
          </li>
        </ul>
      </section>

      <!-- Example Usage -->
      <section class="doc-section">
        <h2>Usage Example</h2>
        <pre class="code-block"><code>
GenericSparseTable&lt;Integer&gt; st = new GenericSparseTable&lt;&gt;(
    List.of(2, 4, 6, 8, 10),
    Integer::min,
    true // overlap-safe
);

System.out.println(st.query(1, 3)); // prints 4
        </code></pre>
        <p>
          If the operation is not overlap-safe (like sum), pass
          <code>false</code> and use fallback disjoint intervals:
        </p>
        <pre class="code-block"><code>
GenericSparseTable&lt;Integer&gt; sumTable = new GenericSparseTable&lt;&gt;(
    List.of(1, 2, 3, 4),
    Integer::sum,
    false // not overlap-safe
);

System.out.println(sumTable.query(0, 3)); // prints 10
        </code></pre>
      </section>
    </div>
    <footer>© 2025 Java Generic DSA Utils | Manoj Kumar G</footer>
    <script src="../../../scripts/docs.js"></script>
  </body>
</html>
